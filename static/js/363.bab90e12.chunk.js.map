{"version":3,"file":"static/js/363.bab90e12.chunk.js","mappings":"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","sources":["webpack://ts-react-app/./src/custom-component/Button/index.less?9e7b","custom-component/Button/index.tsx","webpack://ts-react-app/./src/custom-component/Circle/index.less?9bdf","custom-component/Circle/index.tsx","custom-component/Image/index.tsx","webpack://ts-react-app/./src/custom-component/Music/index.less?9d9e","custom-component/Music/index.tsx","webpack://ts-react-app/./src/custom-component/Rect/index.less?04c6","custom-component/Rect/index.tsx","webpack://ts-react-app/./src/custom-component/Text/index.less?2b6a","custom-component/Text/index.tsx","hook/useAction.ts","utils/event.ts","utils/runAnimation.ts","utils/style.ts","webpack://ts-react-app/./src/views/View/index.less?59ae","webpack://ts-react-app/./src/components/PreviewComponentWrap/index.less?47b1","components/PreviewComponentWrap/index.tsx","views/View/index.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"button\":\"index_button__QsKQn\"};","import { ComponentListItem } from \"../component-list\";\r\nimport Text from \"../Text\";\r\nimport styles from \"./index.less\";\r\n\r\ninterface ButtonProps {\r\n  element: ComponentListItem;\r\n}\r\n\r\nconst Button: React.FC<ButtonProps> = function ({ element }) {\r\n  return (\r\n    <div className={styles.button} style={element.style}>\r\n      <Text element={element} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Button;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"circle\":\"index_circle__FXthc\",\"preview\":\"index_preview__2WhI+\"};","import { ComponentListItem } from \"../component-list\";\r\nimport Text from \"../Text\";\r\nimport styles from \"./index.less\";\r\n\r\ninterface CircleProps {\r\n  element: ComponentListItem;\r\n}\r\n\r\nconst Circle: React.FC<CircleProps> = function ({ element }) {\r\n  return (\r\n    <div className={styles.circle} style={element.style}>\r\n      <Text element={element} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Circle;\r\n","interface ImageProps {\r\n  propValue: string;\r\n}\r\n\r\nconst Image: React.FC<ImageProps> = ({ propValue }) => {\r\n  return (\r\n    <img\r\n      style={{ height: \"100%\", width: \"100%\", overflow: \"hidden\" }}\r\n      src={propValue}\r\n      alt=\"\"\r\n    />\r\n  );\r\n};\r\n\r\nexport default Image;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"music\":\"index_music__RPBgP\"};","import { ComponentListItem } from \"../component-list\";\r\nimport Text from \"../Text\";\r\nimport styles from \"./index.less\";\r\n\r\ninterface MusicProps {\r\n  element: ComponentListItem;\r\n}\r\n\r\nconst Music: React.FC<MusicProps> = function ({ element }) {\r\n  return (\r\n    <div className={styles.music} style={element.style}>\r\n      Music\r\n      <audio\r\n        autoPlay\r\n        src=\"https://other-web-ra01-sycdn.kuwo.cn/5c650cd4d3b798405ed9bfab4ae1fe18/63941698/resource/n3/320/31/1/1060334909.mp3\"\r\n      ></audio>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Music;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"rect\":\"index_rect__fBigi\"};","import { ComponentListItem } from \"../component-list\";\r\nimport Text from \"../Text\";\r\nimport styles from \"./index.less\";\r\n\r\ninterface RectProps {\r\n  element: ComponentListItem;\r\n}\r\n\r\nconst Rect: React.FC<RectProps> = function ({ element }) {\r\n  return (\r\n    <div className={styles.rect} style={element.style}>\r\n      <Text element={element} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Rect;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"text\":\"index_text__66qHR\",\"can-edit\":\"index_can-edit__99vF5\",\"preview\":\"index_preview__ydwEx\"};","import { useEffect, useRef, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { State } from \"@/state/reducer\";\r\nimport { ComponentListItem } from \"../component-list\";\r\nimport styles from \"./index.less\";\r\nimport useAction from \"@/hook/useAction\";\r\n\r\ninterface TextProps {\r\n  element: ComponentListItem;\r\n}\r\n\r\nconst Text: React.FC<TextProps> = function ({ element }) {\r\n  const { editMode, curComponent } = useSelector(\r\n    (state: State) => state.editor\r\n  );\r\n  const { setComponentContent } = useAction();\r\n  const [canEdit, setCanEdit] = useState(false);\r\n  const textRef = useRef({} as HTMLDivElement);\r\n\r\n  const setEdit = () => {\r\n    setCanEdit(true);\r\n    selectText(textRef.current);\r\n  };\r\n\r\n  const handleMouseDown = (e: any) => {\r\n    if (canEdit) {\r\n      e.stopPropagation();\r\n    }\r\n  };\r\n\r\n  const handleBlur = (e: any) => {\r\n    if (!e.target.contains(textRef.current)) {\r\n      return;\r\n    }\r\n    if (e.target !== textRef.current) {\r\n      setComponentContent(\r\n        { element, content: textRef.current.innerHTML } || \"&nbsp;\"\r\n      );\r\n      setCanEdit(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (curComponent !== element) {\r\n      setCanEdit(false);\r\n      clearSelectText();\r\n    }\r\n  }, [curComponent]);\r\n\r\n  useEffect(() => {\r\n    if (canEdit) {\r\n      window.addEventListener(\"click\", handleBlur, false);\r\n    } else {\r\n      window.removeEventListener(\"click\", handleBlur);\r\n    }\r\n  }, [canEdit]);\r\n\r\n  const selectText = (element: Node) => {\r\n    const selection = window.getSelection();\r\n    const range = document.createRange();\r\n    range.selectNodeContents(element);\r\n    if (selection) {\r\n      selection.removeAllRanges();\r\n      selection.addRange(range);\r\n    }\r\n  };\r\n\r\n  const clearSelectText = () => {\r\n    const selection = window.getSelection();\r\n    if (selection) {\r\n      selection.removeAllRanges();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {editMode === \"edit\" ? (\r\n        <div className={styles.text}>\r\n          <div\r\n            ref={textRef}\r\n            className={` ${canEdit ? styles[\"can-edit\"] : \"\"}`}\r\n            style={{ verticalAlign: element.style.verticalAlign }}\r\n            contentEditable={canEdit}\r\n            onDoubleClick={setEdit}\r\n            onMouseDown={handleMouseDown}\r\n            dangerouslySetInnerHTML={{ __html: element.propValue }}\r\n          ></div>\r\n        </div>\r\n      ) : (\r\n        <div className={` ${canEdit ? styles[\"can-edit\"] : \"\"}`}>\r\n          {element.propValue}\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Text;\r\n","import { CSSProperties } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { ComponentListItem } from \"../custom-component/component-list\";\r\nimport {\r\n  ActionTypes,\r\n  ContextMenuInfo,\r\n  SetCurComponentPayload,\r\n} from \"../state/constants/actionTypes\";\r\nimport { PageConfig, ProjectConfig } from \"@/types/config\";\r\nimport store from \"@/state/store\";\r\nimport { EditorState } from \"@/state/reducers/editor\";\r\n\r\n/**\r\n * 将dispath action 写成一个hook吧，dispath代码太多了，而且不好看\r\n */\r\nexport default function useAction() {\r\n  const dispatch = useDispatch();\r\n\r\n  return {\r\n    setProjectData(project: ProjectConfig) {\r\n      dispatch({\r\n        type: ActionTypes.SetProjectData,\r\n        payload: project,\r\n      });\r\n    },\r\n\r\n    setCurrentPageUUID(uuid?: string) {\r\n      dispatch({\r\n        type: ActionTypes.SetCurrentPageUUID,\r\n        payload: uuid,\r\n      });\r\n    },\r\n\r\n    addPage(uuid?: string) {\r\n      dispatch({\r\n        type: ActionTypes.AddPage,\r\n        payload: uuid,\r\n      });\r\n    },\r\n\r\n    deletePage(uuid?: string) {\r\n      dispatch({\r\n        type: ActionTypes.DeletePage,\r\n        payload: uuid,\r\n      });\r\n    },\r\n\r\n    copyPage(uuid?: string) {\r\n      dispatch({\r\n        type: ActionTypes.CopyPage,\r\n        payload: uuid,\r\n      });\r\n    },\r\n\r\n    setEditor(editor: any) {\r\n      dispatch({\r\n        type: ActionTypes.SetEditor,\r\n        payload: editor,\r\n      });\r\n    },\r\n\r\n    addComponent(component: ComponentListItem) {\r\n      dispatch({\r\n        type: ActionTypes.AddComponent,\r\n        payload: component,\r\n      });\r\n    },\r\n\r\n    setCurComponent({\r\n      curComponent,\r\n      curComponentIndex,\r\n    }: SetCurComponentPayload) {\r\n      dispatch({\r\n        type: ActionTypes.SetCurComponent,\r\n        payload: {\r\n          curComponent,\r\n          curComponentIndex,\r\n        },\r\n      });\r\n    },\r\n\r\n    setWrapStyle(stlyes: any) {\r\n      dispatch({\r\n        type: ActionTypes.SetWrapStyle,\r\n        payload: stlyes,\r\n      });\r\n    },\r\n\r\n    setClickComponentStatus(status: boolean) {\r\n      dispatch({\r\n        type: ActionTypes.SetClickComponentStatus,\r\n        payload: status,\r\n      });\r\n    },\r\n\r\n    setComponetData(componentData: ComponentListItem[]) {\r\n      dispatch({\r\n        type: ActionTypes.SetComponentData,\r\n        payload: componentData,\r\n      });\r\n    },\r\n\r\n    setComponentStyle(style: CSSProperties) {\r\n      dispatch({\r\n        type: ActionTypes.SetComponentStyle,\r\n        payload: style,\r\n      });\r\n    },\r\n\r\n    setComponentContent(payload: {\r\n      element: ComponentListItem;\r\n      content: string;\r\n    }) {\r\n      dispatch({\r\n        type: ActionTypes.SetComponentContent,\r\n        payload,\r\n      });\r\n    },\r\n\r\n    deleteComponent(index?: number) {\r\n      dispatch({\r\n        type: ActionTypes.DeleteComponent,\r\n        payload: index,\r\n      });\r\n    },\r\n\r\n    upComponent() {\r\n      dispatch({\r\n        type: ActionTypes.UpComponent,\r\n      });\r\n    },\r\n\r\n    downComponent() {\r\n      dispatch({\r\n        type: ActionTypes.DownComponent,\r\n      });\r\n    },\r\n\r\n    topComponent() {\r\n      dispatch({\r\n        type: ActionTypes.TopComponent,\r\n      });\r\n    },\r\n\r\n    bottomComponent() {\r\n      dispatch({\r\n        type: ActionTypes.BottomComponent,\r\n      });\r\n    },\r\n\r\n    updateComponentPropValue(propValue: string) {\r\n      dispatch({\r\n        type: ActionTypes.UpdateComponentPropValue,\r\n        payload: propValue,\r\n      });\r\n    },\r\n\r\n    recordSnapshot() {\r\n      dispatch({\r\n        type: ActionTypes.RecordSnapshot,\r\n      });\r\n    },\r\n\r\n    undo() {\r\n      dispatch({\r\n        type: ActionTypes.Undo,\r\n      });\r\n    },\r\n\r\n    redo() {\r\n      dispatch({\r\n        type: ActionTypes.Redo,\r\n      });\r\n    },\r\n\r\n    copy() {\r\n      dispatch({\r\n        type: ActionTypes.Copy,\r\n      });\r\n    },\r\n\r\n    paste(isMouse?: boolean) {\r\n      dispatch({\r\n        type: ActionTypes.Paste,\r\n        payload: isMouse,\r\n      });\r\n    },\r\n\r\n    cut() {\r\n      dispatch({\r\n        type: ActionTypes.Cut,\r\n      });\r\n    },\r\n\r\n    showContextMenu(info: ContextMenuInfo) {\r\n      dispatch({\r\n        type: ActionTypes.ShowContextMenu,\r\n        payload: info,\r\n      });\r\n    },\r\n\r\n    hideContextMenu() {\r\n      dispatch({\r\n        type: ActionTypes.HideContextMenu,\r\n      });\r\n    },\r\n\r\n    clearCanvas() {\r\n      console.log(\"clear\");\r\n      dispatch({\r\n        type: ActionTypes.SetComponentData,\r\n        payload: [],\r\n      });\r\n      dispatch({\r\n        type: ActionTypes.SetCurComponent,\r\n        payload: {\r\n          curComponent: null,\r\n          curComponentIndex: null,\r\n        },\r\n      });\r\n      dispatch({\r\n        type: ActionTypes.RecordSnapshot,\r\n      });\r\n    },\r\n  };\r\n}\r\n\r\nexport const getCurrentPage = () => {\r\n  const { projectData, currentPageUUID } = store.getState()\r\n    .editor as EditorState;\r\n  return (\r\n    projectData?.pages?.find((page) => page.uuid === currentPageUUID) ||\r\n    ({} as PageConfig)\r\n  );\r\n};\r\n","// 编辑器自定义事件\r\nexport const events: { [x: string]: any } = {\r\n  redirect(url: string) {\r\n    if (url) {\r\n      window.location.href = url;\r\n    }\r\n  },\r\n\r\n  alert(msg: string) {\r\n    if (msg) {\r\n      // eslint-disable-next-line no-alert\r\n      alert(msg);\r\n    }\r\n  },\r\n};\r\n\r\nexport const eventList = [\r\n  {\r\n    key: \"redirect\",\r\n    label: \"跳转事件\",\r\n    event: events.redirect,\r\n    param: \"\",\r\n  },\r\n  {\r\n    key: \"alert\",\r\n    label: \"alert 事件\",\r\n    event: events.alert,\r\n    param: \"\",\r\n  },\r\n];\r\n","import { AnimationItem } from \"./animationClassData\";\r\n\r\nexport default async function runAnimation(\r\n  $el: any,\r\n  animations: AnimationItem[] = []\r\n) {\r\n  const play = (animation: AnimationItem) =>\r\n    new Promise<void>((resolve) => {\r\n      const { animationTime, value = \"\", isLoop = false } = animation;\r\n      $el.style.setProperty(\"--time\", animationTime + \"s\");\r\n      $el.classList.add(value, \"animate__animated\", utilsHandle(isLoop));\r\n      const removeAnimation = () => {\r\n        $el.removeEventListener(\"animationend\", removeAnimation);\r\n        $el.removeEventListener(\"animationcancel\", removeAnimation);\r\n        $el.classList.remove(value, \"animate__animated\", utilsHandle(isLoop));\r\n        $el.style.removeProperty(\"--time\");\r\n        resolve();\r\n      };\r\n\r\n      $el.addEventListener(\"animationend\", removeAnimation);\r\n      $el.addEventListener(\"animationcancel\", removeAnimation);\r\n    });\r\n\r\n  for (let i = 0, len = animations.length; i < len; i++) {\r\n    await play(animations[i]);\r\n  }\r\n}\r\n\r\nfunction utilsHandle(isLoop: boolean) {\r\n  return isLoop ? \"animate__infinite\" : \"animate__no-infinite\";\r\n}\r\n","export function getComponentWrapStyle(style: { [x: string]: string }) {\r\n  const result: { [x: string]: string } = {};\r\n  [\"width\", \"height\", \"top\", \"left\", \"rotate\"].forEach((attr) => {\r\n    if (attr !== \"rotate\") {\r\n      result[attr] = style[attr];\r\n    } else {\r\n      result.transform = \"rotate(\" + style[attr] + \"deg)\";\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n// 需要单位的样式\r\nconst needUnit = [\r\n  \"fontSize\",\r\n  \"width\",\r\n  \"height\",\r\n  \"top\",\r\n  \"left\",\r\n  \"borderWidth\",\r\n  \"letterSpacing\",\r\n  \"borderRadius\",\r\n];\r\n\r\nconst svgFilterAttrs = [\"width\", \"height\", \"top\", \"left\", \"rotate\"];\r\n\r\nexport function getStyle(\r\n  style: { [x: string]: string },\r\n  filter: string[] = []\r\n) {\r\n  const result: { [x: string]: string } = {};\r\n  Object.keys(style).forEach((key) => {\r\n    if (!svgFilterAttrs.includes(key)) {\r\n      if (key !== \"rotate\") {\r\n        result[key] = style[key];\r\n\r\n        // if (needUnit.includes(key)) {\r\n        //   result[key] += \"px\";\r\n        // }\r\n      } else {\r\n        result.transform = key + \"(\" + style[key] + \"deg)\";\r\n      }\r\n    }\r\n  });\r\n\r\n  return result;\r\n}\r\n","// extracted by mini-css-extract-plugin\nexport default {\"content\":\"index_content__kZcTY\"};","// extracted by mini-css-extract-plugin\nexport default {\"component-wrap\":\"index_component-wrap__7Gp8d\"};","import { CSSProperties, ReactElement, useEffect, useRef } from \"react\";\r\nimport { ComponentListItem } from \"@/custom-component/component-list\";\r\nimport styles from \"./index.less\";\r\nimport runAnimation from \"@/utils/runAnimation\";\r\nimport { events } from \"@/utils/event\";\r\n\r\ninterface PreviewComponentWrapProps {\r\n  element: ComponentListItem;\r\n  children: ReactElement;\r\n  defaultStyle: CSSProperties;\r\n  style: CSSProperties;\r\n}\r\n\r\nconst PreviewComponentWrap: React.FC<PreviewComponentWrapProps> = ({\r\n  element,\r\n  children,\r\n  defaultStyle,\r\n  style,\r\n}) => {\r\n  const ref = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (!element.fns) {\r\n      element.fns = {};\r\n    }\r\n    if (element.animations.length > 0) {\r\n      element.fns[\"animation\"] = () => {\r\n        runAnimation(ref.current, element.animations);\r\n      };\r\n      element.fns[\"animation\"]();\r\n    }\r\n    for (let event in element.events) {\r\n      element.fns[event] = () => events[event](element.events[event]);\r\n      if (ref.current) {\r\n        ref.current.style.cursor = \"pointer\";\r\n        ref.current.onclick = element.fns[event];\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div ref={ref} className={`${styles[\"component-wrap\"]}`} style={style}>\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PreviewComponentWrap;\r\n","import styles from \"./index.less\";\r\nimport { ComponentListItem } from \"@/custom-component/component-list\";\r\nimport Text from \"@/custom-component/Text\";\r\nimport Button from \"@/custom-component/Button\";\r\nimport Rect from \"@/custom-component/Rect\";\r\nimport Circle from \"@/custom-component/Circle\";\r\nimport Image from \"@/custom-component/Image\";\r\nimport Music from \"@/custom-component/Music\";\r\nimport \"animate.css\";\r\nimport PreviewComponentWrap from \"@/components/PreviewComponentWrap\";\r\nimport { getComponentWrapStyle } from \"@/utils/style\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { getPageDetail } from \"@/api\";\r\nimport { FlipType, ProjectConfig } from \"../../types/config\";\r\nimport { Swiper, SwiperSlide } from \"swiper/react\";\r\nimport \"swiper/css\";\r\n\r\ninterface ViewProps {\r\n  id?: string;\r\n  projectData?: ProjectConfig;\r\n}\r\n\r\nconst View: React.FC<ViewProps> = ({\r\n  id: propsId,\r\n  projectData: propsProjectData,\r\n}) => {\r\n  const [projectData, setProjectData] = useState<ProjectConfig>();\r\n  const { id } = useParams();\r\n\r\n  useEffect(() => {\r\n    async function getDetail() {\r\n      try {\r\n        const res = await getPageDetail(id || propsId || \"\");\r\n        setProjectData(res.result);\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    }\r\n    if (!propsProjectData) {\r\n      getDetail();\r\n    } else {\r\n      setProjectData(propsProjectData);\r\n    }\r\n  }, []);\r\n\r\n  const getComponent = (item: ComponentListItem) => {\r\n    switch (item.component) {\r\n      case \"Text\": {\r\n        return <Text element={item} />;\r\n      }\r\n\r\n      case \"Button\": {\r\n        return <Button element={item} />;\r\n      }\r\n\r\n      case \"Rect\": {\r\n        return <Rect element={item} />;\r\n      }\r\n\r\n      case \"Circle\": {\r\n        return <Circle element={item} />;\r\n      }\r\n\r\n      case \"Image\": {\r\n        return <Image propValue={item.propValue} />;\r\n      }\r\n\r\n      case \"Music\": {\r\n        return <Music element={item} />;\r\n      }\r\n\r\n      default: {\r\n        return <Text element={item} />;\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {projectData?.isPublish ? (\r\n        <Swiper\r\n          direction={\r\n            projectData?.flipType === FlipType.UpDown\r\n              ? \"vertical\"\r\n              : \"horizontal\"\r\n          }\r\n          style={{\r\n            width: projectData?.width,\r\n            height: projectData?.height,\r\n          }}\r\n          slidesPerView={1}\r\n          onSlideChange={() => console.log(\"slide change\")}\r\n          onSwiper={(swiper) => console.log(swiper)}\r\n        >\r\n          {projectData?.pages?.map((page) => {\r\n            return (\r\n              <SwiperSlide key={page.uuid} style={{ width: \"100%\" }}>\r\n                <div\r\n                  style={{\r\n                    width: projectData.width,\r\n                    height: projectData.height,\r\n                    transform: `scale(${projectData.scale / 100})`,\r\n                    ...page?.pageStyle,\r\n                    backgroundImage: page?.pageStyle\r\n                      ? `url(${page?.pageStyle.backgroundImage})`\r\n                      : \"\",\r\n                  }}\r\n                >\r\n                  <div className={styles.content}>\r\n                    <div style={{ ...projectData.canvasStyleData }}>\r\n                      {page?.componentData.map((item) => {\r\n                        return (\r\n                          <PreviewComponentWrap\r\n                            key={item.id}\r\n                            defaultStyle={item.style}\r\n                            style={getComponentWrapStyle(item.style)}\r\n                            element={item}\r\n                          >\r\n                            {getComponent(item)}\r\n                          </PreviewComponentWrap>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </SwiperSlide>\r\n            );\r\n          })}\r\n        </Swiper>\r\n      ) : (\r\n        <></>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default View;\r\n"],"names":["element","className","styles","style","Text","propValue","height","width","overflow","src","alt","autoPlay","useSelector","state","editor","editMode","curComponent","setComponentContent","useAction","useState","canEdit","setCanEdit","textRef","useRef","handleBlur","e","target","contains","current","content","innerHTML","useEffect","clearSelectText","window","addEventListener","removeEventListener","selectText","selection","getSelection","range","document","createRange","selectNodeContents","removeAllRanges","addRange","ref","verticalAlign","contentEditable","onDoubleClick","onMouseDown","stopPropagation","dangerouslySetInnerHTML","__html","dispatch","useDispatch","setProjectData","project","type","ActionTypes","payload","setCurrentPageUUID","uuid","addPage","deletePage","copyPage","setEditor","addComponent","component","setCurComponent","curComponentIndex","setWrapStyle","stlyes","setClickComponentStatus","status","setComponetData","componentData","setComponentStyle","deleteComponent","index","upComponent","downComponent","topComponent","bottomComponent","updateComponentPropValue","recordSnapshot","undo","redo","copy","paste","isMouse","cut","showContextMenu","info","hideContextMenu","clearCanvas","console","log","getCurrentPage","store","projectData","currentPageUUID","pages","find","page","events","redirect","url","location","href","alert","msg","eventList","key","label","event","param","runAnimation","$el","animations","play","animation","Promise","resolve","animationTime","value","isLoop","setProperty","classList","add","utilsHandle","removeAnimation","remove","removeProperty","i","len","length","getComponentWrapStyle","result","forEach","attr","transform","children","defaultStyle","fns","cursor","onclick","propsId","id","propsProjectData","useParams","getPageDetail","res","getDetail","getComponent","item","Button","Rect","Circle","Image","Music","isPublish","direction","flipType","FlipType","slidesPerView","onSlideChange","onSwiper","swiper","map","scale","pageStyle","backgroundImage","canvasStyleData"],"sourceRoot":""}